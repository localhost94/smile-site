<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMILE Cloud Infrastructure</title>
    <link rel="stylesheet" href="../assets/styles/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        .confluence-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        .confluence-content {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-xl);
            padding: 3rem;
            box-shadow: var(--shadow-lg);
            margin-top: 2rem;
        }
        .confluence-content h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 2rem;
            color: var(--text-primary);
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 0.5rem;
        }
        .confluence-content h2 {
            font-size: 2rem;
            font-weight: 600;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            color: var(--primary-dark);
        }
        .confluence-content h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }
        .confluence-content p {
            font-size: 1.125rem;
            line-height: 1.8;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }
        .confluence-content ul, .confluence-content ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }
        .confluence-content li {
            margin-bottom: 0.5rem;
            line-height: 1.7;
        }
        .confluence-content img {
            max-width: 100%;
            height: auto;
            border-radius: var(--radius-md);
            margin: 1.5rem 0;
            box-shadow: var(--shadow-md);
        }
        .confluence-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        .confluence-content th, .confluence-content td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        .confluence-content th {
            background: var(--bg-tertiary);
            font-weight: 600;
            color: var(--text-primary);
        }
        .confluence-content tr:last-child td {
            border-bottom: none;
        }
        .confluence-content pre {
            background: var(--text-primary);
            color: #f8f8f2;
            padding: 1.5rem;
            border-radius: var(--radius-md);
            overflow-x: auto;
            margin: 1rem 0;
        }
        .confluence-content code {
            background: var(--bg-tertiary);
            padding: 0.2rem 0.4rem;
            border-radius: var(--radius-sm);
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
        }
        .confluence-content pre code {
            background: none;
            padding: 0;
        }
        .confluence-content blockquote {
            border-left: 4px solid var(--primary-color);
            padding-left: 1rem;
            margin: 1.5rem 0;
            color: var(--text-secondary);
            font-style: italic;
        }
        .confluence-content a {
            color: var(--primary-color);
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: border-color 0.2s;
        }
        .confluence-content a:hover {
            border-bottom-color: var(--primary-color);
        }
        .back-nav {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .back-nav a {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: var(--radius-md);
            font-weight: 500;
            transition: all 0.2s;
        }
        .back-nav a:hover {
            background: var(--primary-dark);
            transform: translateX(-5px);
        }
        .back-nav span {
            color: var(--text-secondary);
        }
        .toc {
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
        }
        .toc h3 {
            margin-top: 0;
            margin-bottom: 1rem;
            font-size: 1.125rem;
            color: var(--text-primary);
        }
        .toc ul {
            margin: 0;
            padding-left: 1.5rem;
        }
        .toc li {
            margin-bottom: 0.5rem;
        }
        .toc a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.2s;
        }
        .toc a:hover {
            color: var(--primary-color);
        }
        .page-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        .hidden {
            display: none;
        }
    </style>
</head>

    <body>
    <header class="header">
        <div class="header-container">
            <a href="../index.html" class="logo">
                <div class="logo-icon">S</div>
                <span>SMILE Platform</span>
            </a>
            <nav class="nav-links">
                <a href="../index.html#docs" class="nav-link">Documentation</a>
                <a href="../index.html#about" class="nav-link">About</a>
                <a href="../index.html#contact" class="nav-link">Contact</a>
            </nav>
        </div>
    </header>

    <div class="confluence-wrapper">
        <div class="back-nav">
            <a href="../index.html">
                <span>←</span> Back to Documentation
            </a>
            <span>Home / Documentation / Cloud Infrastructure</span>
        </div>

        <div class="confluence-content">
            <h1>SMILE Cloud Infrastructure</h1>
            <div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>This article was last updated on <time datetime="2025-06-26" class="date-past">26 Jun 2025</time> </p></div></div><style type='text/css'>/*<![CDATA[*/
div.rbtoc1766968432309 {padding: 0px;}
div.rbtoc1766968432309 ul {list-style: default;margin-left: 0px;}
div.rbtoc1766968432309 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1766968432309'>
<ul class='toc-indentation'>
<li><a href='#SMILECloudInfrastructure-About'>About</a></li>
<li><a href='#SMILECloudInfrastructure-CloudInfrastructure'>Cloud Infrastructure</a></li>
<li><a href='#SMILECloudInfrastructure-EnvironmentStructure'>Environment Structure</a></li>
<li><a href='#SMILECloudInfrastructure-InfrastructureRequirements'>Infrastructure Requirements</a>
<ul class='toc-indentation'>
<li><a href='#SMILECloudInfrastructure-ApplicationRequirement'>Application Requirement</a></li>
<li><a href='#SMILECloudInfrastructure-DataAnalysisRequirements'>Data Analysis Requirements</a></li>
<li><a href='#SMILECloudInfrastructure-OtherResourcesRequirements'>Other Resources Requirements</a></li>
</ul>
</li>
<li><a href='#SMILECloudInfrastructure-ArchitectureDiagram'>Architecture Diagram</a></li>
<li><a href='#SMILECloudInfrastructure-NetworkArchitecture'>Network Architecture</a></li>
<li><a href='#SMILECloudInfrastructure-ComputeResources'>Compute Resources</a>
<ul class='toc-indentation'>
<li><a href='#SMILECloudInfrastructure-KubernetesClusters(EKS)'>Kubernetes Clusters (EKS)</a>
<ul class='toc-indentation'>
<li><a href='#SMILECloudInfrastructure-ApplicationCluster'>Application Cluster</a></li>
<li><a href='#SMILECloudInfrastructure-DataCluster'>Data Cluster</a></li>
</ul>
</li>
<li><a href='#SMILECloudInfrastructure-EC2Instances'>EC2 Instances</a></li>
</ul>
</li>
<li><a href='#SMILECloudInfrastructure-DatabaseServices'>Database Services</a>
<ul class='toc-indentation'>
<li><a href='#SMILECloudInfrastructure-MySQLRDSInstances'>MySQL RDS Instances</a></li>
</ul>
</li>
<li><a href='#SMILECloudInfrastructure-Messaging&amp;Caching'>Messaging &amp; Caching</a></li>
<li><a href='#SMILECloudInfrastructure-Storage'>Storage</a></li>
<li><a href='#SMILECloudInfrastructure-ContainerRegistry'>Container Registry</a></li>
<li><a href='#SMILECloudInfrastructure-SupportingAWSServices'>Supporting AWS Services</a></li>
<li><a href='#SMILECloudInfrastructure-Security&amp;Access'>Security &amp; Access</a></li>
<li><a href='#SMILECloudInfrastructure-Monitoring&amp;Observability'>Monitoring &amp; Observability</a></li>
<li><a href='#SMILECloudInfrastructure-Traffic&amp;CI/CDFlow'>Traffic &amp; CI/CD Flow</a></li>
<li><a href='#SMILECloudInfrastructure-RevisionHistory'>Revision History</a></li>
</ul>
</div><h1 id="SMILECloudInfrastructure-About">About</h1><hr/><p>This document provides a comprehensive architectural overview of the SMILE application’s cloud infrastructure and deployment strategy across its Development, Staging, and Production environments. The application is deployed on Amazon Web Services (AWS) within the <strong>Jakarta Region (ap-southeast-3)</strong> and utilises <strong>Kubernetes (Amazon EKS)</strong> for container orchestration.</p><p>It outlines the structure and purpose of each environment, key AWS services used, Kubernetes namespace segregation, CI/CD workflows, traffic routing, observability tooling, and security configurations. The goal is to offer a clear understanding of how SMILE is deployed, maintained, and monitored in a scalable, secure, and automated cloud-native ecosystem.</p><h1 id="SMILECloudInfrastructure-CloudInfrastructure">Cloud Infrastructure</h1><hr/><ul><li><p><strong>Cloud Provider</strong>: AWS</p></li><li><p><strong>Region</strong>: <code>ap-southeast-3</code> (Jakarta)</p></li><li><p><strong>Orchestration</strong>: Amazon EKS (Elastic Kubernetes Service)</p></li><li><p><strong>Data Layer</strong>: Amazon RDS, Kafka, Debezium, RisingWave, Pentaho</p></li><li><p><strong>Security &amp; Networking</strong>: VPC, NAT Gateway, Bastion, Route53, Cloudflare</p></li></ul><h1 id="SMILECloudInfrastructure-EnvironmentStructure">Environment Structure</h1><hr/><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="53ba14f2-83e7-44a1-89fb-f6a951e56ca5" class="confluenceTable"><tbody><tr><th class="confluenceTh"><p style="text-align: center;"><strong>Environment</strong></p></th><th class="confluenceTh"><p style="text-align: center;"><strong>Purpose</strong></p></th><th class="confluenceTh"><p style="text-align: center;"><strong>Deployment Target</strong></p></th><th class="confluenceTh"><p style="text-align: center;"><strong>Notes</strong></p></th></tr><tr><td class="confluenceTd"><p>Dev</p></td><td class="confluenceTd"><p>Developer testing, previews</p></td><td class="confluenceTd"><p>AWS Cloud / Ephemeral EKS or shared Dev cluster</p></td><td class="confluenceTd"><p>May share some infrastructure; automated deployment from feature branches.</p></td></tr><tr><td class="confluenceTd"><p>Staging</p></td><td class="confluenceTd"><p>Pre-prod testing, QA, validation</p></td><td class="confluenceTd"><p><code>*-uat</code> clusters on AWS (EKS, RDS, etc.)</p></td><td class="confluenceTd"><p>Mirror the production structure for testing and validation.</p></td></tr><tr><td class="confluenceTd"><p>Production</p></td><td class="confluenceTd"><p>Live workloads</p></td><td class="confluenceTd"><p>Fully isolated AWS infrastructure</p></td><td class="confluenceTd"><p>High-availability, security-hardened, scaling-enabled.</p></td></tr></tbody></table></div><h1 id="SMILECloudInfrastructure-InfrastructureRequirements">Infrastructure Requirements</h1><hr/><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>The following requirements are applicable to deployments in Indonesia; specifications may vary in other countries.</p></div></div><h2 id="SMILECloudInfrastructure-ApplicationRequirement">Application Requirement</h2><div class="table-wrap"><table data-table-width="894" data-layout="center" data-local-id="093fdc53-fd00-4cf4-a8d6-721c326b3f0d" class="confluenceTable"><colgroup><col style="width: 331.0px;"/><col style="width: 91.0px;"/><col style="width: 248.0px;"/><col style="width: 224.0px;"/></colgroup><tbody><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p style="text-align: center;"><strong>Resource</strong></p></td><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p style="text-align: center;"><strong>Qty</strong></p></td><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p style="text-align: center;"><strong>Details</strong></p></td><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p style="text-align: center;"><strong>Comments</strong></p></td></tr><tr><td class="confluenceTd"><p>Amazon ECR</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>1TB Storage – 1TB transfer</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>EKS Cluster (Application Cluster)</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>EKS Cluster</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>Amazon EC2</p></td><td class="confluenceTd"><p style="text-align: center;">5</p></td><td class="confluenceTd"><ul><li><p>m6g.2xlarge</p></li><li><p>8vCPU</p></li><li><p>32 GiB Memory</p></li><li><p>200GB Disk</p></li></ul></td><td class="confluenceTd"><p>Hosted on Application EKS Cluster</p></td></tr><tr><td class="confluenceTd"><p>Amazon RDS</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><ul><li><p>db.m5.4xlarge</p></li><li><p>vCPU: 16</p></li><li><p>Memory: 64 GiB</p></li><li><p>1TB</p></li></ul></td><td class="confluenceTd"><p>Common for both App and Data setup</p></td></tr><tr><td class="confluenceTd"><p>Amazon ElastiCache</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>Cache m5.xLarge</p></td><td rowspan="2" class="confluenceTd"><p>Agreed: Use AWS Managed service</p></td></tr><tr><td class="confluenceTd"><p>Amazon MQ</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>mq.m5.large</p></td></tr><tr><td class="confluenceTd"><p>Amazon ALB</p></td><td class="confluenceTd"><p style="text-align: center;">4</p></td><td class="confluenceTd"><p>Application LB</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>Amazon API Gateway</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>API Gateway</p></td><td class="confluenceTd"><p>Agreed: Not in use for now, we will use it as per App requirement in future</p></td></tr><tr><td class="confluenceTd"><p>AWS Secrets Manager</p></td><td class="confluenceTd"><p style="text-align: center;">10</p></td><td class="confluenceTd"><p>Secrets Manager</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>Amazon EC2</p></td><td class="confluenceTd"><p style="text-align: center;">2</p></td><td class="confluenceTd"><ul><li><p>m6g.2xlarge </p></li><li><p>8vCPU</p></li><li><p>32 GiB Memory </p></li><li><p>200GB</p></li></ul></td><td class="confluenceTd"><p>WMS Estimation</p></td></tr><tr><td class="confluenceTd"><p>Amazon RDS</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>db.m5.2xlarge</p></td><td class="confluenceTd"><p>WMS Estimation</p></td></tr></tbody></table></div><h2 id="SMILECloudInfrastructure-DataAnalysisRequirements">Data Analysis Requirements</h2><div class="table-wrap"><table data-table-width="894" data-layout="center" data-local-id="b47f4233-4640-4b35-9592-470d29710097" class="confluenceTable"><colgroup><col style="width: 324.0px;"/><col style="width: 98.0px;"/><col style="width: 270.0px;"/><col style="width: 202.0px;"/></colgroup><tbody><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p style="text-align: center;"><strong>Resource</strong></p></td><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p style="text-align: center;"><strong>Qty</strong></p></td><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p style="text-align: center;"><strong>Details</strong></p></td><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p style="text-align: center;"><strong>Comments</strong></p></td></tr><tr><td class="confluenceTd"><p>OLTP: </p><p>Amazon RDS - My SQL(App DB)</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>Same RDS Instance to be used, as mentioned above</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>EKS Cluster (Data Cluster)</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p> </p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>Amazon OLAP(Clickhouse): Amazon EC2</p></td><td class="confluenceTd"><p style="text-align: center;">5 Nodes</p></td><td class="confluenceTd"><ul><li><p>d3en.2xlarge</p></li><li><p>8 vCPUs</p></li><li><p>32 GiB Memory</p></li></ul></td><td class="confluenceTd"><p>Hosted on Data EKS Cluster</p></td></tr><tr><td class="confluenceTd"><p>Kafka: Amazon EC2</p></td><td class="confluenceTd"><p style="text-align: center;">3 Nodes</p></td><td class="confluenceTd"><ul><li><p>d3en.2xlarge</p></li><li><p>8 vCPUs</p></li><li><p>32 GiB</p></li><li><p>3TB</p></li></ul></td><td class="confluenceTd"><p>Hosted on Data EKS Cluster</p></td></tr><tr><td class="confluenceTd"><p>Zookeeper Nodes: Amazon EC2</p></td><td class="confluenceTd"><p style="text-align: center;">3 Nodes</p></td><td class="confluenceTd"><ul><li><p>d3en.2xlarge</p></li><li><p>8 vCPUs</p></li><li><p>32 GiB Memory</p></li><li><p>3TB</p></li></ul></td><td class="confluenceTd"><p>Hosted on Data EKS Cluster</p></td></tr><tr><td class="confluenceTd"><p>ETL (Pentaho): Amazon EC2</p></td><td class="confluenceTd"><p style="text-align: center;">1 node</p></td><td class="confluenceTd"><ul><li><p>t3.2xlarge or m5.2xlarge</p></li><li><p>8vCPUs</p></li><li><p>32GB RAM</p></li><li><p>250 GB storage</p></li></ul></td><td class="confluenceTd"><p>Hosted on Data EKS Cluster</p></td></tr></tbody></table></div><h2 id="SMILECloudInfrastructure-OtherResourcesRequirements">Other Resources Requirements</h2><div class="table-wrap"><table data-table-width="892" data-layout="center" data-local-id="807e3a64-7671-4f7f-b309-7e85edad5c8b" class="confluenceTable"><colgroup><col style="width: 327.0px;"/><col style="width: 103.0px;"/><col style="width: 267.0px;"/><col style="width: 195.0px;"/></colgroup><tbody><tr><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p style="text-align: center;"><strong>Resource</strong></p></td><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p style="text-align: center;"><strong>Quantity</strong></p></td><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p style="text-align: center;"><strong>Details</strong></p></td><td data-highlight-colour="#f4f5f7" class="confluenceTd"><p style="text-align: center;"><strong>Comments</strong></p></td></tr><tr><td class="confluenceTd"><p>Security Hub</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>N/A</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>AWS Config</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>N/A</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>CloudTrail</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>N/A</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>GuardDuty</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>N/A</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>Cloudwatch</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>N/A</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>AWS Backup</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>N/A</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>S3 Buckets</p></td><td class="confluenceTd"><p style="text-align: center;"> </p></td><td class="confluenceTd"><p> </p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>Route 53</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p> </p></td><td class="confluenceTd"><p>For DNS records</p></td></tr><tr><td class="confluenceTd"><p>Bastion Host + SSM</p></td><td class="confluenceTd"><p style="text-align: center;"> </p></td><td class="confluenceTd"><p>t3.large</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>Git repository</p></td><td class="confluenceTd"><p style="text-align: center;">1</p></td><td class="confluenceTd"><p>t3.xlarge(4:16)</p></td><td class="confluenceTd"><p>Use one server across all the environments </p></td></tr></tbody></table></div><h1 id="SMILECloudInfrastructure-ArchitectureDiagram">Architecture Diagram</h1><hr/><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-center" alt="image-20250522-045953.png" width="760" loading="lazy" src="attachments/5791318028/5791285281.png?width=760" data-image-src="attachments/5791318028/5791285281.png" data-height="1462" data-width="1421" data-unresolved-comment-count="0" data-linked-resource-id="5791285281" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20250522-045953.png" data-base-url="https://unicc.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="5791318028" data-linked-resource-container-version="9" data-media-id="4000c20a-3dd8-47e0-91c5-b9c4dfca46d9" data-media-type="file"></span><h1 id="SMILECloudInfrastructure-NetworkArchitecture">Network Architecture</h1><hr/><ul><li><p><strong>VPC</strong>: Single VPC with CIDR 10.0.0.0/16</p></li><li><p><strong>Subnets</strong>:</p><ul><li><p><strong>EC2 Private</strong>: For general compute resources</p></li><li><p><strong>EKS Private</strong>: For Kubernetes workloads</p></li><li><p><strong>Intra</strong>: For internal resources</p></li><li><p><strong>Public</strong>: For internet-facing resources</p></li></ul></li><li><p><strong>NAT Gateway</strong>: Enables outbound internet access for private resources</p></li><li><p><strong>Flow Logs</strong>: Network traffic monitoring stored in S3</p></li></ul><h1 id="SMILECloudInfrastructure-ComputeResources">Compute Resources</h1><hr/><h2 id="SMILECloudInfrastructure-KubernetesClusters(EKS)">Kubernetes Clusters (EKS)</h2><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-center" alt="image-20250619-101810.png" width="1280" loading="lazy" src="attachments/5791318028/5842698251.png?width=1280" data-image-src="attachments/5791318028/5842698251.png" data-height="601" data-width="1402" data-unresolved-comment-count="0" data-linked-resource-id="5842698251" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20250619-101810.png" data-base-url="https://unicc.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="5791318028" data-linked-resource-container-version="9" data-media-id="1a0b4c11-1b16-41c8-b4df-f6f3afa655cb" data-media-type="file"></span><p>SMILE uses two separate EKS clusters:</p><h3 id="SMILECloudInfrastructure-ApplicationCluster"><strong>Application Cluster</strong></h3><p><strong>Purpose</strong>: Runs the main application services</p><p><strong>Node Types</strong>:</p><ul><li><p>Main application nodes (ARM-based m6g.2xlarge)</p></li><li><p>WMS nodes (ARM-based m6g.xlarge)</p></li></ul><h3 id="SMILECloudInfrastructure-DataCluster"><strong>Data Cluster</strong></h3><p><strong>Purpose</strong>: Handles data processing workloads</p><p><strong>Node Types</strong>:</p><ul><li><p>OLAP processing (d3en.2xlarge)</p></li><li><p>Kafka messaging (d3en.2xlarge)</p></li><li><p>Zookeeper coordination (d3en.2xlarge)</p></li><li><p>ETL processing (t3.2xlarge)</p></li><li><p>ClickHouse database (d3en.2xlarge)</p></li></ul><h2 id="SMILECloudInfrastructure-EC2Instances">EC2 Instances</h2><p><strong>Bastion Host</strong>: Secure jump server for accessing private resources</p><ul><li><p><strong>Instance Type</strong>: t3.small</p></li><li><p><strong>Purpose</strong>: SSH access to private network resources</p></li></ul><h1 id="SMILECloudInfrastructure-DatabaseServices">Database Services</h1><hr/><h3 id="SMILECloudInfrastructure-MySQLRDSInstances">MySQL RDS Instances</h3><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="67b55c5e-cae1-4406-aae6-310d2f787144" class="confluenceTable"><colgroup><col style="width: 233.0px;"/><col style="width: 146.0px;"/><col style="width: 227.0px;"/><col style="width: 152.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p style="text-align: center;"><strong>Database</strong></p></th><th class="confluenceTh"><p style="text-align: center;"><strong>Engine</strong></p></th><th class="confluenceTh"><p style="text-align: center;"><strong>Size</strong></p></th><th class="confluenceTh"><p style="text-align: center;"><strong>Backups</strong></p></th></tr><tr><td class="confluenceTd"><p>Main Application</p></td><td class="confluenceTd"><p>MySQL 8.0</p></td><td class="confluenceTd"><p><code>db.m5.4xlarge</code> </p><p>500GB storage</p></td><td class="confluenceTd"><p>Daily with 7-day retention</p></td></tr><tr><td class="confluenceTd"><p>Waste Management System</p></td><td class="confluenceTd"><p>MySQL 8.0</p></td><td class="confluenceTd"><p><code>db.m5.xlarge</code></p><p>200GB storage</p></td><td class="confluenceTd"><p>Daily with 7-day retention</p></td></tr></tbody></table></div><h1 id="SMILECloudInfrastructure-Messaging&amp;Caching">Messaging &amp; Caching</h1><hr/><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="4a410bce-6407-47b5-9bcb-7b6b38d366d3" class="confluenceTable"><colgroup><col style="width: 192.0px;"/><col style="width: 229.0px;"/><col style="width: 69.0px;"/><col style="width: 144.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p style="text-align: center;"><strong>Service</strong></p></th><th class="confluenceTh"><p><strong>Purpose</strong></p></th><th class="confluenceTh"><p><strong>Version</strong></p></th><th class="confluenceTh"><p><strong>Instance</strong></p></th></tr><tr><td class="confluenceTd"><p>AmazonMQ (RabbitMQ)</p></td><td class="confluenceTd"><p>Application messaging and event handling</p></td><td class="confluenceTd"><p>3.13</p></td><td class="confluenceTd"><p><code>mq.m5.large</code></p></td></tr><tr><td class="confluenceTd"><p>ElastiCache (Redis)</p></td><td class="confluenceTd"><p>Application caching and session management</p></td><td class="confluenceTd"><p>6.2</p></td><td class="confluenceTd"><p><code>cache.m5.xlarge</code></p></td></tr></tbody></table></div><h1 id="SMILECloudInfrastructure-Storage">Storage</h1><hr/><p><strong>S3 Buckets</strong>:</p><ul><li><p>Application data</p></li><li><p>Network flow logs (30-day retention)</p></li><li><p>Observability data (Loki and Tempo)</p></li></ul><h1 id="SMILECloudInfrastructure-ContainerRegistry">Container Registry</h1><hr/><p><strong>ECR Repositories </strong>for application components:</p><ul><li><p>Backend services (core, main, platform, auth, sync, warehouse)</p></li><li><p>Frontend web application</p></li><li><p>WMS services (backend, frontend, mobile, BFF)</p></li><li><p>Lifecycle policy: Untagged images removed after 14 days</p></li></ul><h1 id="SMILECloudInfrastructure-SupportingAWSServices">Supporting AWS Services</h1><hr/><ul><li><p><strong>Amazon Relational Database Service (RDS)</strong>: Relational data storage;</p></li><li><p><strong>Amazon Elastic Kubernetes Service (EKS)</strong>: Running Kubernetes cluster on AWS;</p></li><li><p><strong>Amazon ElastiCache</strong>: Caching purpose;</p></li><li><p><strong>Amazon Message Queueing (MQ)</strong>: Message broker;</p></li><li><p><strong>Amazon Simple Storage Service (S3)</strong>: File and object storage;</p></li><li><p><strong>Amazon Secrets Manager</strong>: Secret storage (DB creds, API keys);</p></li><li><p><strong>Amazon Backup</strong>: Backup service.</p></li></ul><h1 id="SMILECloudInfrastructure-Security&amp;Access">Security &amp; Access</h1><hr/><ul><li><p><strong>Cloudflare</strong>: DNS and edge security;</p></li><li><p><strong>Route 53</strong>: Internal/external routing;</p></li><li><p><strong>Bastion host</strong>: Access gateway to private subnet;</p></li><li><p><strong>NAT Gateway</strong>: Enables private subnet access to the internet (e.g., for updates).</p></li><li><p><strong>Security Groups</strong>: Defined for each service with least-privilege access</p></li><li><p><strong>IAM</strong>: Infrastructure user with appropriate permissions</p></li><li><p><strong>Secrets Manager</strong>: Secure storage for application credentials</p></li><li><p><strong>WAF</strong>: Web Application Firewall protecting the application cluster</p></li></ul><h1 id="SMILECloudInfrastructure-Monitoring&amp;Observability">Monitoring &amp; Observability</h1><hr/><ul><li><p><strong>Prometheus + Grafana</strong>: Metrics and dashboards;</p></li><li><p><strong>Jaeger</strong>: Tracing;</p></li><li><p><strong>Loki</strong>: Log aggregation;</p></li><li><p><strong>OTel Collector</strong>: Unified telemetry collection.</p></li></ul><h1 id="SMILECloudInfrastructure-Traffic&amp;CI/CDFlow">Traffic &amp; CI/CD Flow</h1><hr/><ol start="1"><li><p><strong>External Traffic</strong>: Hits Cloudflare → Route 53 → Load Balancer → EKS (via Istio);</p></li><li><p><strong>Internal Communication</strong>: Services communicate securely via Istio (Service Mesh);</p></li><li><p><strong>CI/CD Pipeline</strong>:</p><ul><li><p><strong>GitLab</strong>: Source Code Management (SCM)</p></li><li><p><strong>Jenkins</strong>: Build and deployment automation</p></li></ul></li></ol><h1 id="SMILECloudInfrastructure-RevisionHistory">Revision History</h1><hr/><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p><strong>Internal Use Only. This content is not intended for publication in the live environment.</strong></p></div></div><div class="table-wrap"><table data-table-width="760" data-layout="center" data-local-id="914f1f88-3ea8-45ee-b0ac-978d03427f76" data-table-display-mode="fixed" class="confluenceTable"><colgroup><col style="width: 125.0px;"/><col style="width: 366.0px;"/><col style="width: 152.0px;"/><col style="width: 117.0px;"/></colgroup><tbody><tr><th data-highlight-colour="#f0f1f2" class="confluenceTh"><p style="text-align: center;"><strong>Date</strong></p></th><th data-highlight-colour="#f0f1f2" class="confluenceTh"><p style="text-align: center;"><strong>Change description</strong></p></th><th data-highlight-colour="#f0f1f2" class="confluenceTh"><p style="text-align: center;"><strong>Author</strong></p></th><th data-highlight-colour="#f0f1f2" class="confluenceTh"><p style="text-align: center;"><strong>Status</strong></p></th></tr><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><p><time datetime="2025-07-07" class="date-past">07 Jul 2025</time> </p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p>Added new input from Infra Team</p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p style="text-align: center;">TW</p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p style="text-align: center;">Done</p></td></tr><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><p><time datetime="2025-06-26" class="date-past">26 Jun 2025</time> </p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p>Proofread content.</p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p style="text-align: center;">Lead TW</p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p style="text-align: center;">Done</p></td></tr><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><p><time datetime="2025-06-19" class="date-past">19 Jun 2025</time> </p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p>Updated on some sections and reviewed by SA</p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p style="text-align: center;">TW</p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p style="text-align: center;">Done</p></td></tr><tr><td data-highlight-colour="#ffffff" class="confluenceTd"><p> <time datetime="2025-05-22" class="date-past">22 May 2025</time> </p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p> Initial Document</p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p style="text-align: center;">TW</p></td><td data-highlight-colour="#ffffff" class="confluenceTd"><p style="text-align: center;">Done </p></td></tr></tbody></table></div>
                    </div>

                                        <div class="pageSection group">
                        <h2 id="SMILECloudInfrastructure-ArchitectureDiagram" class="section-title">Architecture Diagram</h2>
                        <p><img src="../assets/attachments/5791318028/5791285281.png" alt="Architecture Diagram" style="max-width: 760px; width: 100%; height: auto;" /></p>
                    </div>

                    <div class="pageSection group">
                        <h2 id="SMILECloudInfrastructure-NetworkArchitecture" class="section-title">Network Architecture</h2>
                        <p>Single VPC with CIDR 10.0.0.0/16</p>
                    </div>

                    <div class="pageSection group">
                        <h2 id="SMILECloudInfrastructure-KubernetesClusters(EKS)" class="section-title">Kubernetes Clusters (EKS)</h2>
                        <p><img src="../assets/attachments/5791318028/5842698251.png" alt="Kubernetes Clusters" style="max-width: 1280px; width: 100%; height: auto;" /></p>
                        <p>SMILE uses two separate EKS clusters:</p>
                    </div>

                    <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="../assets/images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="../assets/attachments/5791318028/5791285281.png">image-20250522-045953.png</a> (image/png)
                                <br/>
                                                            <img src="../assets/images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="../assets/attachments/5791318028/5842698251.png">image-20250619-101810.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                    <div class="page-info">
                        <div>Last updated: 26 Jun 2025</div>
                        <div>SMILE Platform Documentation</div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="footer">
            <div class="footer-container">
                <div class="footer-links">
                    <a href="#" class="footer-link">Privacy Policy</a>
                    <a href="#" class="footer-link">Terms of Use</a>
                    <a href="#" class="footer-link">Support</a>
                </div>
                <div class="footer-text">
                    © 2024 SMILE Platform. A Digital Public Good initiative.
                </div>
            </div>
        </footer>
    </body>
</html>
